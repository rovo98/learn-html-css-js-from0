<!DOCTYPE html>
<!--
    author : rovo98
    date: 2018.8.8
-->
<html lang="en">
<head>
    <title>使用 AJAX 加载 xml 文件中的数据 </title>
    <meta charset="utf-8">
    <style>
        #wrap {
            width: 800px;
            height: 100%;
            margin: 20px auto;
            padding: 20px 40px;
            border: 1px solid #ccc;
            box-shadow: 0 5px 10px #666;
            -webkit-box-shadow: 0 5px 10px #666;
            -moz-box-shadow: 0 5px 10px #666;
            -o-box-shadow: 0 5px 10px #666;
        }

        .content {
            width: 100%;
            height: 100%;
            margin: 20px auto;
            padding: 10px;
            border-collapse: collapse;
            box-shadow: 0 5px 10px #666;
            -webkit-box-shadow: 0 5px 10px #666;
            -moz-box-shadow: 0 5px 10px #666;
            -o-box-shadow: 0 5px 10px #666;
        }
        table.content,
        .content td {
            border: 1px solid #ccc;
            text-align: center;
        }
        .content caption {
            font-size : 2em;
            font-weight : bold;
            margin : 20px auto;
        }
        .content th {
            color: #fff;
            font-weight: bold;
            background-color: #323232;
        }
    </style>
    <script>
        <!--
        // 用于加载 XML 文件中的数据
        function loadXMLData(url) {
            var xmlHttp;
            var txt, x;
            if (window.XMLHttpRequest) {
                xmlHttp = new XMLHttpRequest();
            } else {
                xmlHttp = new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlHttp.onreadystatechange = function () {
                if (xmlHttp.readyState === 4 && xmlHttp.status === 200) {
                    // do something here after xml data loaded.
                    var resp = xmlHttp.responseXML;
                    txt = "<table class='content'>" +
                        "<caption>书籍信息表</caption><tr>" +
                        "<th>title</th>" +
                        "<th>artist</th>" +
                        "<th>country</th>" +
                        "<th>company</th>" +
                        "<th>price</th>" +
                        "<th>year</th>" +
                        +"</tr>";
                    var item = resp.getElementsByTagName("CD");

                    for (var i = 0; i < item.length; i++) {
                        txt = txt + "<tr>";
                        x = item[i].getElementsByTagName("TITLE");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        x = item[i].getElementsByTagName("ARTIST");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        x = item[i].getElementsByTagName("COUNTRY");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        x = item[i].getElementsByTagName("COMPANY");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        x = item[i].getElementsByTagName("PRICE");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        x = item[i].getElementsByTagName("YEAR");
                        try {
                            txt = txt + "<td>" + x[0].firstChild.nodeValue + "</td>";
                        } catch (err) {
                            txt = txt + "<td></td>";
                        }
                        txt = txt + "</tr>";
                    }
                    txt = txt + "</table>";
                    document.getElementById("getData").style.display = "none";
                    var node = document.createElement("div");
                    document.getElementById("wrap").appendChild(node);
                    node.innerHTML = txt;
                }
            };
            xmlHttp.open("GET", url, true);
            xmlHttp.send();
        }
        -->
    </script>
</head>
<body>
<div id="wrap">
    <h1>使用 AJAX 获取 XML 文件中的数据 </h1>
    <button onclick="loadXMLData('cd_catalog.xml')" type="button" id="getData">获取xml数据</button>
</div>
</body>
</html>

